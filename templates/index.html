<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Geo-Tagged Photo Taker</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
  <header>
    <h1>Geo-Tagged Photo Taker</h1>
    <p class="muted">Capture geo-tagged photos. Images are signed so you can verify later whether the visible overlay
      was changed.</p>
  </header>

  <main>
    <section class="camera">
      <div class="video-wrapper">
        <video id="video" autoplay playsinline muted></video>
        <canvas id="canvas" style="display:none;"></canvas>
      </div>

      <div class="controls">
        <label for="deviceSelect">Camera:</label>
        <select id="deviceSelect"></select>
        <button id="btnStart">Enable Camera</button>
        <button id="btnCapture" disabled>Capture & Save</button>
      </div>

      <div id="errors" class="errors hidden"></div>
      <p class="muted small">Use <code>http://127.0.0.1:5000</code>. Allow camera & location in the browser and OS
        privacy settings.</p>
    </section>

    <section id="result" class="hidden">
      <h2>Saved!</h2>
      <img id="preview" alt="Captured preview" />
      <div class="meta">
        <p><strong>Title:</strong> <span id="titleLine"></span></p>
        <p><strong>Detail:</strong> <span id="detailLine"></span></p>
        <p><strong>Lat/Long:</strong> <span id="latlonLine"></span></p>
        <p><strong>Time:</strong> <span id="timeLine"></span></p>
        <p><a id="downloadLink" href="#" download>Download annotated JPEG</a></p>
        <p><a href="/public_key.pem" target="_blank">Download public key (for independent verification)</a></p>
      </div>
    </section>

    <section class="verify">
      <h3>Verify an image</h3>
      <p class="muted small">Upload a saved image produced by this app (or any image that claims to be original). The
        app will check the embedded signature to determine whether the visible pixels were changed since signing.</p>
      <input type="file" id="verifyInput" accept="image/jpeg,image/jpg" />
      <button id="verifyBtn">Verify Image</button>
      <div id="verifyResult" class="muted small"></div>
    </section>

    <section class="notice">
      <h3>Consent & Privacy</h3>
      <p class="muted small">Only photograph people who consent and comply with local laws. Images are saved locally on
        this server; no cloud uploads are performed by this app unless you choose to upload an image to /verify.</p>
    </section>
  </main>

  <script src="{{ url_for('static', filename='script.js') }}" defer></script>
</body>

</html>